<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ùêä·¥Äùê∞s·¥Ä Ä</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif}
  body{
    min-height:100vh;
    color:#222;
    background:linear-gradient(135deg,#e0e0e0 0%,#c9c9c9 100%);
    animation:fadeBg 12s ease-in-out infinite alternate;
  }

  @keyframes fadeBg{
    0%{background:linear-gradient(135deg,#e0e0e0 0%,#c9c9c9 100%);}
    50%{background:linear-gradient(135deg,#d7d7d7 0%,#bfbfbf 100%);}
    100%{background:linear-gradient(135deg,#ebebeb 0%,#d0d0d0 100%);}
  }

  header{
    background:linear-gradient(90deg,#1e1e1e 0%,#3a3a3a 35%,#d4af37 100%);
    color:#fff;
    text-align:center;
    padding:10px 20px;
    font-size:1.0em;
    font-weight:600;
    border-radius:12px;
    box-shadow:0 6px 20px rgba(0,0,0,.3);
    position:sticky;
    top:10px;
    z-index:120;
    letter-spacing:0px;
    transition:.3s;
  }

  .shop-name-wrapper{display:flex;justify-content:center;align-items:center;margin:18px 0}
  .shop-name{
    font-size:1.5em;
    font-weight:600; /* ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø ‡¶π‡ßá‡¶°‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶Æ‡ßã‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø */
    padding:20px 40px;
    border-radius:100px;
    background:linear-gradient(90deg,#1e1e1e 0%,#3a3a3a 35%,#d4af37 100%);
    color:#fff;
    text-shadow:0 2px 5px rgba(0,0,0,0.3);
    box-shadow:0 10px 30px rgba(255,215,0,0.3);
    border:2px solid #fff;
    text-align:center;
    transition:.3s;
    animation:glow 3s ease-in-out infinite alternate;
  }
  @keyframes glow {
    from { box-shadow:0 0 15px rgba(255,215,0,0.3); }
    to { box-shadow:0 0 30px rgba(255,215,0,0.6); }
  }

  .container{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
    gap:16px;
    padding:20px;
    margin-top:8px;
  }

  .product{
    background:linear-gradient(145deg,#ffffff,#f1f1f1);
    border-radius:18px;
    overflow:hidden;
    box-shadow:0 8px 20px rgba(0,0,0,0.1);
    transition:all .3s ease;
    cursor:pointer;
    border:2px solid rgba(0,0,0,0.05);
    position:relative;
  }
  .product:hover{
    transform:translateY(-8px) scale(1.03);
    box-shadow:0 12px 26px rgba(0,0,0,0.18);
    background:linear-gradient(145deg,#fefefe,#fafafa);
  }

  .product::before{
    content:"";
    position:absolute;
    inset:0;
    border-radius:18px;
    background:radial-gradient(circle at 30% 30%,rgba(255,192,203,0.4),transparent 60%),
               radial-gradient(circle at 70% 70%,rgba(135,206,250,0.4),transparent 60%);
    opacity:0;
    transition:opacity .4s ease;
  }
  .product:hover::before{opacity:1;}

  .product img{
    width:100%;
    height:180px;
    object-fit:contain;
    transition:.3s;
  }
  .product:hover img{transform:scale(1.07);}

  .product-info{
    padding:12px 10px;
    text-align:center;
    background:rgba(255,255,255,0.85);
  }
  .product-info h3{
    font-size:1em;
    font-weight:600;
    margin-bottom:6px;
    color:#111;
  }
  .product-info p{
    color:#ff007f;
    font-weight:700;
    font-size:0.95em;
  }

  #productPage{display:none;padding:16px;min-height:70vh}
  .productPageWrapper{
    display:flex;
    gap:20px;
    align-items:flex-start;
    justify-content:center;
    flex-wrap:wrap;
  }

  .imagesColumn{
    flex:1;
    display:flex;
    gap:16px;
    max-width:800px;
  }
  .imagesColumn .imgWrap{
    flex:1;
    background:#fff;
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 6px 18px rgba(0,0,0,.08);
    opacity:0;
    transform:translateY(20px);
    animation:fadeSlide 0.5s forwards;
  }
  .imagesColumn .imgWrap:nth-child(1){animation-delay:0.1s;}
  .imagesColumn .imgWrap:nth-child(2){animation-delay:0.3s;}

  @keyframes fadeSlide{
    to{opacity:1;transform:translateY(0);}
  }

  .imagesColumn img{
    width:100%;
    height:auto;
    max-height:calc(100vh - 180px);
    object-fit:contain;
    display:block;
    cursor:pointer;
    border-radius:12px;
  }

  .fullscreen-view{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.9);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:9999;
    animation:fadeIn .3s ease;
  }
  .fullscreen-view img{
    max-width:95%;
    max-height:95%;
    border-radius:12px;
    box-shadow:0 0 20px rgba(255,255,255,0.3);
  }
  .fullscreen-view.closeable{cursor:pointer;}

  .orderColumn{
    width:320px;
    background:linear-gradient(180deg,#ffffff,#fbfbfb);
    border-radius:12px;
    padding:18px;
    box-shadow:0 8px 30px rgba(0,0,0,.08);
    display:flex;flex-direction:column;gap:12px;align-items:center;
    position:sticky;top:84px;height:fit-content
  }
  .orderColumn h2{font-size:1.25em;text-align:center}
  .orderColumn .price{font-weight:700;font-size:1.05em;color:#111}
  .orderColumn .desc{font-size:0.95em;color:#444;text-align:center}
  .bigBtn{
    display:inline-block;
    background:linear-gradient(135deg,#25D366,#128C7E);
    color:#fff;padding:14px 22px;border-radius:30px;
    text-decoration:none;font-weight:700;font-size:1.05em;
    box-shadow:0 8px 18px rgba(37,211,102,.25);
    border:none;transition:.3s;
  }
  .bigBtn:hover{transform:scale(1.05);}
  .bigBtn:active{transform:translateY(1px)}
  .phone{display:none;}
  .share-note{font-size:0.82em;color:#666;text-align:center;padding-top:6px}

  .product-desc-frame{
    background:linear-gradient(135deg,#7f00ff,#e100ff);
    color:#fff;
    border:none;
    box-shadow:0 5px 20px rgba(127,0,255,0.4);
    padding:15px 20px;border-radius:14px;text-align:center;font-size:1em;font-weight:500;
    margin-bottom:25px;animation:fadeIn .4s ease;
  }
  @keyframes fadeIn{from{opacity:0;transform:translateY(-10px);}to{opacity:1;transform:translateY(0);}}

  @media (max-width:880px){
    .container{grid-template-columns:repeat(2,1fr)}
    .product img{max-height:180px}
    .productPageWrapper{flex-direction:column;align-items:center}
    .orderColumn{width:92%;position:static;top:auto}
    .imagesColumn{flex-direction:row;gap:12px}
    .imagesColumn img{max-height:50vh}
  }
  @media (max-width:480px){
    .container{grid-template-columns:repeat(2,1fr);gap:10px;padding:10px}
    .product img{max-height:160px}
    .imagesColumn img{max-height:45vh}
    .bigBtn{padding:12px 18px;font-size:1em}
  }
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<header id="mainHeader">WELCOME</header>
<div class="shop-name-wrapper" id="shopNameWrapper"><div class="shop-name" id="shopNameDiv">Network Problem</div></div>

<div id="home" class="container"></div>

<div id="productPage">
  <div id="productDescFrame"></div>
  <div class="productPageWrapper">
    <div class="imagesColumn" id="detailImagesColumn"></div>
    <div class="orderColumn" id="orderColumn">
      <h2 id="detailName">Product Name</h2>
      <div class="price" id="detailPrice">‡ß≥ 0</div>
      <div class="phone" id="displayPhone">+8801000000000</div>
      <a id="orderBtn" class="bigBtn" href="#" target="_blank" rel="noopener">Order via WhatsApp</a>
      <div class="share-note">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶® ‚Äî ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶¨‡•§</div>
    </div>
  </div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBAReBLso7XIMl1SaRfY8wbhZC6QZXCS2c",
  authDomain: "kawsar-shop.firebaseapp.com",
  databaseURL: "https://kawsar-shop-default-rtdb.firebaseio.com",
  projectId: "kawsar-shop",
  storageBucket: "kawsar-shop.firebasestorage.app",
  messagingSenderId: "266776611771",
  appId: "1:266776611771:web:8fe316c69e5b65b6df929e",
  measurementId: "G-R8GSV3FG1G"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let products = [];
let whatsappNumber = "8801000000000";
let shopName = "‡¶¨‡¶ø‡¶∏‡¶Æ‡¶ø‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶ñ‡ßá‡¶≤‡¶æ‡¶ò‡¶∞";
let headerText = "‡¶Ü‡¶∏‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ ‡¶Ü‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ";

const homeContainer = document.getElementById('home');
const header = document.getElementById("mainHeader");
const shopNameDiv = document.getElementById("shopNameDiv");

// Firebase ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
db.ref("products").on("value", s=>{
  const val = s.val();
  if(!val) products = [];
  else if(Array.isArray(val)) products = val.filter(Boolean);
  else products = Object.keys(val).map(k=>val[k]);
  renderProducts();
});

db.ref("whatsappNumber").on("value", s=>{if(s.val()) whatsappNumber=s.val();});
db.ref("shopName").on("value", s=>{
  if(s.val()){
    shopName=s.val();
    shopNameDiv.innerText = shopName;
  }
});
db.ref("headerText").on("value", s=>{
  if(s.val()){
    headerText=s.val();
    if(header.innerText!==headerText){header.innerText=headerText;}
  }
});

// Products render ‡¶ï‡¶∞‡¶æ
function renderProducts(){
  homeContainer.innerHTML='';
  products.forEach((p,i)=>{
    const d=document.createElement('div');
    d.className='product';
    d.onclick=()=>showProductPage(i);
    d.innerHTML=`
      <img src="${p.homeImg||'https://via.placeholder.com/400x300?text=No+Image'}" alt="${escapeHtml(p.name||'Product')}">
      <div class="product-info"><h3>${escapeHtml(p.name||'Untitled')}</h3><p>${escapeHtml(p.price||'‡ß≥ 0')}</p></div>`;
    homeContainer.appendChild(d);
  });
}

// Product page ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
function showProductPage(i){
  const p = products[i]; if(!p) return;
  document.getElementById('home').style.display='none';
  document.getElementById('productPage').style.display='block';
  document.getElementById('mainHeader').style.display='none';
  document.getElementById('shopNameWrapper').style.display='none';

  const descFrame = document.getElementById('productDescFrame');
  descFrame.innerHTML = '';
  const descBox = document.createElement('div');
  descBox.className='product-desc-frame';
  descBox.textContent = p.desc || '‡¶è‡¶á ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶®‡ßá‡¶á‡•§';
  descFrame.appendChild(descBox);

  const col = document.getElementById('detailImagesColumn');
  col.innerHTML = '';
  const imgs = [p.detailImg1, p.detailImg2];
  if(!imgs[0] && p.homeImg) imgs[0]=p.homeImg;
  if(!imgs[1] && p.homeImg) imgs[1]=p.homeImg;
  imgs.forEach((url,j)=>{
    const wrap = document.createElement('div'); wrap.className='imgWrap';
    const img = document.createElement('img');
    img.src=url||'https://via.placeholder.com/800x600?text=No+Image';
    img.alt=`${p.name}-${j+1}`;
    img.onclick=()=>openFullscreen(img.src);
    wrap.appendChild(img); col.appendChild(wrap);
  });

  document.getElementById('detailName').innerText=p.name||'Product';
  document.getElementById('detailPrice').innerText=p.price||'‡ß≥ 0';
  const msg=encodeURIComponent(`Hello! I want to order: ${p.name||''} (${p.price||''})`);
  document.getElementById('orderBtn').href=`https://wa.me/${sanitizePhone(whatsappNumber)}?text=${msg}`;

  history.pushState({page:"product"},"","#product");
  window.scrollTo({top:0,behavior:'smooth'});
}

// Fullscreen view
function openFullscreen(src){
  const full=document.createElement('div');
  full.className='fullscreen-view closeable';
  full.innerHTML=`<img src="${src}" alt="Full Image">`;
  full.onclick=()=>closeFullscreen();
  document.body.appendChild(full);
  history.pushState({page:"fullscreen"},"","#fullscreen");
}
function closeFullscreen(){
  const full=document.querySelector('.fullscreen-view');
  if(full) document.body.removeChild(full);
}

// Back function
function goBack(){
  const full=document.querySelector('.fullscreen-view');
  if(full){
    closeFullscreen();
    return;
  }
  document.getElementById('productPage').style.display='none';
  document.getElementById('home').style.display='grid';
  document.getElementById('mainHeader').style.display='block';
  document.getElementById('shopNameWrapper').style.display='flex';
  window.scrollTo({top:0,behavior:'smooth'});
}

function sanitizePhone(p){if(!p)return'';return p.replace(/[^\d+]/g,'').replace(/^\+?88/,'88');}
function escapeHtml(s){return String(s).replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));}

window.addEventListener("popstate", e=>{
  const full=document.querySelector('.fullscreen-view');
  if(full){
    closeFullscreen();
    return;
  }
  const productPage=document.getElementById("productPage");
  if(productPage.style.display==="block"){
    goBack();
  } else {
    document.getElementById('productPage').style.display='none';
    document.getElementById('home').style.display='grid';
    document.getElementById('mainHeader').style.display='block';
    document.getElementById('shopNameWrapper').style.display='flex';
  }
});

window.onload=()=>{history.pushState(null,null,location.href);};
</script>
</body>
</html>